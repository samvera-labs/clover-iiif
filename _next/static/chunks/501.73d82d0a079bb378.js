"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[501],{1676:function(e,t,n){n.d(t,{x:function(){return i}});let i=(0,n(6216).zo)("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}})},226:function(e,t,n){n.d(t,{J:function(){return o}});var i=n(5893);n(7294);var a=n(1676);let o=e=>(0,i.jsx)(a.x,{...e,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",children:e.children});o.Title=e=>{let{children:t}=e;return(0,i.jsx)("title",{children:t})},o.Add=()=>(0,i.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),o.Audio=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),(0,i.jsx)("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),(0,i.jsx)("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})]}),o.Close=()=>(0,i.jsx)("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),o.Download=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),(0,i.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})]}),o.Image=()=>(0,i.jsx)("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),o.Video=()=>(0,i.jsx)("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"})},1446:function(e,t,n){var i=n(5893),a=n(7294);t.Z=e=>{let{children:t,rootMargin:n="100px",attributes:o={},isVisibleCallback:r=()=>{}}=e,l=(0,a.useRef)(null),[s,d]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=l.current;if(!e)return;let t=new IntersectionObserver(e=>{let[n]=e;n.isIntersecting&&(r(!0),d(!0),t.disconnect())},{rootMargin:n});return t.observe(e),()=>t.disconnect()},[l]),(0,i.jsx)("div",{ref:l,...o,children:s?t:null})}},2583:function(e,t,n){n.d(t,{Hz:function(){return d},bC:function(){return l},tr:function(){return c},uv:function(){return u},yP:function(){return s}});var i=n(6419),a=n(6216);let o=(0,a.F4)({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),r=(0,a.F4)({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),l=(0,a.zo)(i.Eh,{fill:"$secondaryAlt"}),s=(0,a.zo)(i.x8,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),d=(0,a.zo)(i.VY,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:r},'&[data-side="bottom"]':{animationName:o},'&[data-align="end"]':{["& ".concat(l)]:{margin:"0 0.7rem"}}}),c=(0,a.zo)(i.xz,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),u=(0,a.zo)(i.fC,{boxSizing:"content-box"})},113:function(e,t,n){n.d(t,{JO:function(){return i.J},J2:function(){return r},Vp:function(){return s}});var i=n(226),a=n(5893),o=n(2583);n(7294);let r=e=>{let{children:t}=e;return(0,a.jsx)(o.uv,{children:t})};r.Trigger=e=>(0,a.jsx)(o.tr,{...e,children:e.children}),r.Content=e=>(0,a.jsxs)(o.Hz,{...e,sideOffset:5,collisionPadding:21,children:[(0,a.jsx)(o.bC,{}),(0,a.jsx)(o.yP,{children:(0,a.jsx)(i.J,{isSmall:!0,children:(0,a.jsx)(i.J.Close,{})})}),e.children]});var l=n(1676);let s=(0,n(6216).zo)("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"2px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},["".concat(l.x)]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}})},9501:function(e,t,n){n.r(t),n.d(t,{default:function(){return tG}});var i=n(5893),a=n(7294),o=n(9176),r=n(9290),l=n(1032),s=n(8013),d=n(334),c=n(6016);let u=async(e,t)=>{let n=e.get({id:t,type:"Canvas"});if(!(null==n?void 0:n.annotations)||!n.annotations[0])return[];let i=e.get(n.annotations).filter(e=>!!e.items&&e),a=[];for(let t of i)if(t.items.length>0){let e=t.label||{none:["Annotations"]};a.push({...t,label:e})}else{let n={};try{n=await e.load(t.id)}catch(e){console.log(e)}if(n.items&&n.items.length>0){let e=n.label||{none:["Annotations"]};a.push({...n,label:e})}}return a},p=async(e,t,n)=>{try{if(void 0==n||void 0==n.q)return{};let i=n.q.trim(),a=new URL(t);return a.searchParams.set("q",i),await e.load(a.toString())}catch(e){return console.warn("Error in getContentSearchResources:",e),{}}};var h=n(4511),m=n(2641),v=n(6216);let f=(0,v.zo)("div",{position:"relative",zIndex:"0"}),g=(0,v.zo)("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden"}),x=(0,v.zo)("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"100%",height:"100%","&[data-aside-active='true']":{width:"61.8%","@sm":{width:"0",opacity:"0"}},"&[data-aside-toggle='false']":{"@sm":{width:"100% !important",opacity:"1 !important"}}}),b=(0,v.zo)("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"0",maxHeight:"100%","&[data-aside-active='true']":{width:"38.2%","@sm":{width:"100%"}},"&[data-aside-toggle='false']":{"@sm":{width:"0 !important"}}}),y=(0,v.zo)("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{["& ".concat(g)]:{flexGrow:"1"},["& ".concat(x)]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{}}});var j=n(434);let w=(0,v.zo)(j.fC,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% -  2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),S=(0,v.zo)(j.aV,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"5px solid #6663","@sm":{margin:"0 1rem"}}),C=(0,v.zo)(j.xz,{display:"flex",position:"relative",padding:"0.5rem 1.618rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&[data-value='manifest-back']":{display:"none;","@sm":{display:"block"}},"&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),k=(0,v.zo)(j.VY,{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),z=(0,v.zo)(e=>{let{handleScroll:t,children:n,className:a}=e;return(0,i.jsx)("div",{className:a,onScroll:t,children:n})},{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),I={position:"relative",display:"flex",margin:"0 1.618rem",padding:"0.5rem 0",fontFamily:"inherit",fontSize:"0.8333rem",lineHeight:"1.47rem",color:"inherit",background:"none",borderRadius:"3px",border:"none"},R=(0,v.zo)("button",{textAlign:"left","&:hover":{color:"$accent"}}),A=(0,v.zo)("div",{display:"flex",flexDirection:"column",width:"100%",header:{margin:"0 1.618rem 0.5rem ",fontWeight:700,fontSize:"0.8333rem",em:{fontStyle:"normal",fontWeight:400,opacity:.7}},paddingBottom:"1rem",marginBottom:"1rem",borderBottom:"1px solid #0001"}),M=(0,v.zo)("div",{gap:"1rem",fontSize:"1rem",lineHeight:"1.47em",margin:"0","&[data-content-search=true]":{em:{fontWeight:700,display:"inline"}}}),T=(0,v.zo)("div",{...I,display:"flex",flexDirection:"row",gap:"1rem","&[data-format='text/vtt']":{marginTop:"-1rem","> span":{display:"none"}},"> span":{display:"flex",width:"2rem",height:"2rem",backgroundColor:"#0001",flexShrink:"0",borderRadius:"3px",marginTop:"0.25rem"},["&[dir=rtl] ".concat(M)]:{textAlign:"right !important"}});var L=e=>{let{value:t,handleClick:n}=e;return(0,i.jsx)(R,{onClick:n,children:(0,i.jsx)(M,{dangerouslySetInnerHTML:{__html:t}})})},E=e=>{let{caption:t,handleClick:n,imageUri:a}=e;return(0,i.jsxs)(R,{onClick:n,children:[(0,i.jsx)("img",{src:a,alt:"A visual annotation for ".concat(t)}),(0,i.jsx)("span",{children:t})]})},$=n(7533),P=e=>{let{value:t,handleClick:n}=e,a=(0,$.Z)(t);return(0,i.jsx)(R,{onClick:n,children:(0,i.jsx)(M,{dangerouslySetInnerHTML:{__html:a.html}})})};let F=e=>String(e||"").replace(/\n/g,"<br />");var H=e=>{let{value:t,handleClick:n,isContentSearch:a}=e,o=F(t);return(0,i.jsx)(R,{onClick:n,children:(0,i.jsx)(M,{dangerouslySetInnerHTML:{__html:o},"data-content-search":a})})},D=n(7632),V=n(9821),N=()=>{function e(e){return e.map(e=>{let t=e.identifier||(0,D.Z)();return{...e,identifier:t}})}return{addIdentifiersToParsedCues:e,createNestedCues:function(t){let n=[],i=[];for(let o of e(t)){for(;i.length>0&&i[i.length-1].end<=o.start;)i.pop();if(i.length>0){var a;i[i.length-1].children||(i[i.length-1].children=[]),null===(a=i[i.length-1].children)||void 0===a||a.push(o),i.push(o)}else n.push(o),i.push(o)}return n},isChild:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.some(t=>e.start>=t.start&&e.end<=t.end)},orderCuesByTime:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.sort((e,t)=>e.start-t.start)},parseVttData:function(e){return new Promise((t,n)=>{let i=V.parse(e);i.errors&&i.errors.length&&n(i.errors),t(i.cues.map(e=>({identifier:e.identifier||(0,D.Z)(),start:e.start,end:e.end,align:e.align,html:function(e){let t=function(e){let t=e.replace(/<(c|v|i|b|u|lang|ruby)(?:\.([^\s>]+))?(?:\s([^>]+))?>/g,(e,t,n,i)=>{let a=document.createElement(t);return n&&(a.className=n.replace(/\./g," ")),(null==i?void 0:i.length)>0&&(a.title=i),a.outerHTML.replace(new RegExp("</".concat(t,">$")),"")});return console.log("normalizeVttTags",t),t}(e),n=document.createElement("div");return n.innerHTML=t,function e(t){for(let n of t.children)e(n);if("c"===t.localName||"v"===t.localName){var n;let e=document.createElement("span");for(let n of t.attributes)e.setAttribute(n.name,n.value);e.innerHTML=t.innerHTML,null===(n=t.parentNode)||void 0===n||n.replaceChild(e,t)}}(n),n.innerHTML}(e.text),text:e.text||""})))})}}},O=n(150);let B=(0,v.zo)(O.fC,{display:"flex",flexDirection:"column",width:"100%"}),_=(0,v.zo)(O.ck,{...I,justifyContent:"space-between",textAlign:"left",flexGrow:1,margin:0,marginLeft:"-1rem",padding:"0.618rem 1rem",width:"calc(100% + 2rem)",fontSize:"1rem",strong:{marginLeft:"1rem"},"&:hover":{color:"$accent"},"&[aria-checked='true']":{background:"#6662"}});var W=n(1751);let G=e=>{for(;e&&e!==document.body;){let t=window.getComputedStyle(e).overflowY;if("visible"!==t&&"hidden"!==t&&e.scrollHeight>e.clientHeight)return e;e=e.parentNode}return null};var J=e=>{var t,n;let{html:r,text:l,start:s,end:d}=e,c=(0,o.Cu)(),{activePlayer:u,configOptions:p,isAutoScrollEnabled:h,isUserScrolling:m}=(0,o.D1)(),v=null==p?void 0:null===(n=p.informationPanel)||void 0===n?void 0:null===(t=n.vtt)||void 0===t?void 0:t.autoScroll,[f,g]=(0,a.useState)(!1),x=(0,a.useRef)(null);return(0,a.useEffect)(()=>(null==u||u.addEventListener("timeupdate",()=>{let{currentTime:e}=u;g(s<=e&&e<d)}),()=>document.removeEventListener("timeupdate",()=>{})),[d,s,u]),(0,a.useEffect)(()=>{if(h&&f&&x.current&&!m){let n=x.current;if(n&&n instanceof HTMLElement){let i=G(n);if(i&&i instanceof HTMLElement){var e,t;let a;switch(null==v?void 0:null===(e=v.settings)||void 0===e?void 0:e.block){case"center":let o=i.getBoundingClientRect();a=n.offsetTop+n.offsetHeight-Math.floor((o.bottom-o.top)/2);break;case"end":a=n.offsetTop+n.offsetHeight-(i.clientHeight-n.clientHeight)+2;break;default:a=n.offsetTop-2}t=()=>{var e;return i.scrollTo({top:a,left:0,behavior:null==v?void 0:null===(e=v.settings)||void 0===e?void 0:e.behavior})},c({type:"updateAutoScrolling",isAutoScrolling:!0}),t(),setTimeout(()=>c({type:"updateAutoScrolling",isAutoScrolling:!1}),750)}}}},[v,f,m,h,c]),(0,i.jsxs)(_,{ref:x,"aria-checked":f,"data-testid":"information-panel-cue",onClick:()=>{u&&(u.pause(),u.currentTime=s,u.play())},value:l,children:[(0,i.jsx)("div",{className:"webvtt-cue",dangerouslySetInnerHTML:{__html:r}}),(0,i.jsx)("strong",{children:(0,W.rJ)(s)})]})};let q=(0,v.zo)("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{["& ".concat(_)]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),Z=e=>{let{items:t}=e;return(0,i.jsx)(q,{children:t.map(e=>{let{html:t,text:n,start:a,end:o,children:r,identifier:l}=e;return(0,i.jsxs)("li",{children:[(0,i.jsx)(J,{html:t,text:n,start:a,end:o}),r&&(0,i.jsx)(Z,{items:r})]},l)})})},U=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";if(!e)return"";if(!e[t]){let t=Object.getOwnPropertyNames(e);if(t.length>0)return e[t[0]]}return e[t]};var Y=e=>{let{inlineCues:t,label:n,vttUri:o}=e,[r,l]=a.useState(t||[]),{createNestedCues:s,orderCuesByTime:d,parseVttData:c}=N(),[u,p]=a.useState();return(0,a.useEffect)(()=>{!t&&o&&fetch(o,{redirect:"follow",headers:{Accept:"text/vtt, text/plain, */*"}}).then(e=>{if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return e.text()}).then(e=>{c(e).then(e=>{l(s(d(e)))})}).catch(e=>{console.error(o,e.toString()),p(e)})},[o,t]),(0,i.jsxs)(B,{"data-testid":"annotation-item-vtt","aria-label":"".concat(U(n)),children:[u&&(0,i.jsxs)("div",{"data-testid":"error-message",children:["Network Error: ",u.toString()]}),(0,i.jsx)(Z,{items:r})]})},X=n(404),Q=e=>{var t,n,r,l,s,d,c;let{annotation:u,targetResource:p,isContentSearch:h,isContentState:m}=e,{target:v}=u,f=null==v?void 0:null===(t=v.selector)||void 0===t?void 0:t.type,g=(null==v?void 0:null===(r=v.selector)||void 0===r?void 0:null===(n=r.value)||void 0===n?void 0:n.split("=")[1])||"full",[x,b]="full"!==g?null==g?void 0:g.split(",").slice(2):[100,100],y="".concat(p,"/").concat(g,"/!").concat(((e,t)=>{let n=Math.max(e,t);return[Math.round(e/n*100),Math.round(t/n*100)].join(",")})(x,b),"/0/default.jpg"),j=(0,o.D1)(),w=(0,o.Cu)(),{openSeadragonViewer:S,vault:C,visibleCanvases:k}=j,z=(null==u?void 0:u.body)?null==u?void 0:null===(l=u.body)||void 0===l?void 0:l.map(e=>C.get(e.id)):[],{format:I="PointSelector"===f?"text/vtt":"text/plain",language:R="none",value:A="",chars:M=""}=z[0]?z[0]:{},$="PointSelector"===f?"text/vtt":I,F=(null===(s=z[0])||void 0===s?void 0:s.label)||{none:["t"]},D=A||M||"None",V=R?(0,X.j9)(R).toLocaleLowerCase():"LTR",N="PointSelector"===f&&(null==v?void 0:null===(d=v.selector)||void 0===d?void 0:d.t)?[{start:null==v?void 0:null===(c=v.selector)||void 0===c?void 0:c.t,end:0,html:D,text:D,styles:"",children:[]}]:void 0;function O(){let e=null==S?void 0:S.getOverlayById(u.id);if(e&&(null==S?void 0:S.viewport)){var t;(null==e?void 0:e.element)&&(null===(t=e.element)||void 0===t||t.focus());let n=null==e?void 0:e.getBounds(S.viewport);n.x-=.2,n.y-=.2,n.width+=.5,n.height+=.5,S.viewport.fitBounds(n,!1)}}function B(e){var t;e.preventDefault(),e.stopPropagation();let n=(null==u?void 0:null===(t=u.target)||void 0===t?void 0:t.source)||(null==u?void 0:u.target),i=null==n?void 0:n.id;k.map(e=>e.id).includes(i)?O():w({type:"updateActiveCanvas",canvasId:i})}if((0,a.useEffect)(()=>{if(!S||!m)return;let e=setInterval(()=>{(null==S?void 0:S.getOverlayById(u.id))&&(O(),S.container.className="clover-iiif-content-state",clearInterval(e))},1e3);return()=>clearInterval(e)},[S,m]),I)return(0,i.jsxs)(T,{dir:V,"data-format":I,"data-content":D,className:"clover-iiif-annotation-item",children:[(0,i.jsx)("span",{style:{backgroundImage:"url(".concat(y,")"),backgroundSize:"cover",backgroundPosition:"center"}}),function(){var e,t,n;switch($){case"text/plain":return(0,i.jsx)(H,{value:D,handleClick:B,isContentSearch:h});case"text/html":return(0,i.jsx)(L,{value:D,handleClick:B});case"text/markdown":return(0,i.jsx)(P,{value:D,handleClick:B});case"text/vtt":return(0,i.jsx)(Y,{inlineCues:N,label:F,vttUri:(null===(t=z[0])||void 0===t?void 0:t.id)||void 0});case null==I?void 0:null===(e=I.match(/^image\//))||void 0===e?void 0:e.input:let a=(null===(n=z.find(e=>{var t;return!(null===(t=e.id)||void 0===t?void 0:t.includes("vault://"))}))||void 0===n?void 0:n.id)||"";return(0,i.jsx)(E,{caption:A,handleClick:B,imageUri:a});default:return(0,i.jsx)(H,{value:D,handleClick:B})}}()]})},K=n(8744),ee=e=>{var t,n,a,r,l,s;let{annotationPage:d}=e,{vault:u}=(0,o.D1)();if(!d||!d.items||(null===(t=d.items)||void 0===t?void 0:t.length)===0)return(0,i.jsx)(i.Fragment,{});let p=d.items.map(e=>u.get(e.id));if(!p)return(0,i.jsx)(i.Fragment,{});let h=p.reduce((e,t)=>(e.canvas=t.target.source.id,e.annotations=[],e.annotations.push(null==t?void 0:t.id),e),{}),m=u.get(h.canvas),v=(0,c.G)(u,m.id),f=(null==v?void 0:null===(n=v[0])||void 0===n?void 0:n.service)?(null==v?void 0:null===(r=v[0])||void 0===r?void 0:null===(a=r.service[0])||void 0===a?void 0:a.id)||(null==v?void 0:null===(s=v[0])||void 0===s?void 0:null===(l=s.service[0])||void 0===l?void 0:l["@id"]):void 0;return(0,i.jsxs)(A,{"data-testid":"annotation-page",children:[m&&(0,i.jsx)("header",{children:(0,i.jsx)(K.__,{label:m.label})}),(0,i.jsx)("div",{"data-testid":"annotation-page-items",children:null==p?void 0:p.map(e=>(0,i.jsx)(Q,{annotation:e,targetResource:f},e.id))})]})},et=n(5295);let en=(0,v.zo)("div",{form:{display:"flex",alignItems:"center",width:"100%",height:"100%",gap:"1rem",padding:"0 1.618rem 1.618rem",".content-search-input":{flexGrow:"1",input:{width:"100%",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"1rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0001","&::placeholder":{color:"#0006"}}}}}),ei=(0,v.zo)("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}});var ea=n(9365),eo=e=>{let{searchServiceUrl:t,setContentSearchResource:n,setLoading:r}=e,{t:l}=(0,ea.L)(),[s,d]=(0,a.useState)(),{openSeadragonViewer:c,vault:u}=(0,o.D1)();async function h(e){if(e.preventDefault(),c&&t){if(!s||""===s.trim()){n({});return}r(!0),p(u,t,{q:s}).then(e=>{n(e),r(!1)})}}let m=l("contentSearchPlaceholder");return(0,i.jsx)(en,{children:(0,i.jsxs)(et.fC,{onSubmit:h,className:"content-search-form",children:[(0,i.jsx)(et.gN,{className:"content-search-input",name:"searchTerms",onChange:e=>{e.preventDefault(),d(e.target.value)},children:(0,i.jsx)(et.oT,{placeholder:m})}),(0,i.jsx)(et.k4,{asChild:!0,children:(0,i.jsx)(ei,{type:"submit",children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,i.jsx)("title",{children:l("informationPanelTabsSearch")}),(0,i.jsx)("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})]})})})]})})},er=e=>{let t,{searchServiceUrl:n,setContentSearchResource:r,activeCanvas:l,annotationPage:s}=e,{vault:d}=(0,o.D1)(),{t:u}=(0,ea.L)(),[p,h]=(0,a.useState)(!1),[m,v]=(0,a.useState)({});return(0,a.useEffect)(()=>{var e;(null==s?void 0:s.items)&&v((null==s?void 0:null===(e=s.items)||void 0===e?void 0:e.map(e=>d.get(e.id))).reduce((e,t)=>{let n=t.target.source.id;return e[n]||(e[n]=[]),e[n].push(t.id),e},{}))},[s]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eo,{searchServiceUrl:n,setContentSearchResource:r,activeCanvas:l,setLoading:h}),p?(0,i.jsx)("span",{children:u("contentSearchLoading")}):m&&Object.keys(m).length>0&&Object.keys(m).map(e=>(t=d.get(e),(0,i.jsxs)(A,{"data-testid":"annotation-page",children:[t&&(0,i.jsx)("header",{children:(0,i.jsx)(K.__,{label:t.label})}),m[e].map(e=>{var n,a,o,r,l;let s=d.get(e),u=(0,c.G)(d,t.id),p=(null==u?void 0:null===(n=u[0])||void 0===n?void 0:n.service)?(null==u?void 0:null===(o=u[0])||void 0===o?void 0:null===(a=o.service[0])||void 0===a?void 0:a.id)||(null==u?void 0:null===(l=u[0])||void 0===l?void 0:null===(r=l.service[0])||void 0===r?void 0:r["@id"]):void 0;return(0,i.jsx)(Q,{annotation:s,targetResource:p,isContentSearch:!0},s.id)})]},e)))]})};let el=(0,v.zo)("div",{width:"100%",padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"auto",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.47em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),es=(0,v.zo)("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"});var ed=e=>{let{homepage:t}=e;return(null==t?void 0:t.length)===0?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"manifest-property-title",children:"Homepage"}),(0,i.jsx)(K.bw,{homepage:t})]})},ec=e=>{let{id:t,htmlLabel:n,parent:a="manifest"}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"manifest-property-title",children:n}),(0,i.jsx)("a",{href:t,target:"_blank",id:"iiif-".concat(a,"-id"),children:t})]})},eu=e=>{let{metadata:t,parent:n="manifest"}=e;return t?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(K.SF,{metadata:t,id:"iiif-".concat(n,"-metadata")})}):(0,i.jsx)(i.Fragment,{})},ep=e=>{let{rendering:t}=e;return(null==t?void 0:t.length)===0?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"manifest-property-title",children:"Alternate formats"}),(0,i.jsx)(K.Oy,{rendering:t})]})},eh=e=>{let{requiredStatement:t,parent:n="manifest"}=e;return t?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(K.bT,{requiredStatement:t,id:"iiif-".concat(n,"-required-statement")})}):(0,i.jsx)(i.Fragment,{})},em=e=>{let{rights:t}=e;return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"manifest-property-title",children:"Rights"}),(0,i.jsx)("a",{href:t,target:"_blank",children:t})]}):(0,i.jsx)(i.Fragment,{})},ev=e=>{let{seeAlso:t}=e;return(null==t?void 0:t.length)===0?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"manifest-property-title",children:"See Also"}),(0,i.jsx)(K.QZ,{seeAlso:t})]})},ef=e=>{let{summary:t,parent:n="manifest"}=e;return t?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(K.ER,{summary:t,as:"p",id:"iiif-".concat(n,"-summary")})}):(0,i.jsx)(i.Fragment,{})},eg=e=>{let{label:t,thumbnail:n}=e;return(null==n?void 0:n.length)===0?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(K.pl,{altAsLabel:t||{none:["resource"]},thumbnail:n,style:{backgroundColor:"#6663",objectFit:"cover"}})})},ex=()=>{let{activeManifest:e,vault:t}=(0,o.D1)(),[n,r]=(0,a.useState)(),[l,s]=(0,a.useState)([]),[d,c]=(0,a.useState)([]),[u,p]=(0,a.useState)([]),[h,m]=(0,a.useState)([]);return((0,a.useEffect)(()=>{var n,i,a,o;let l=t.get(e);l&&(r(l),(null===(n=l.homepage)||void 0===n?void 0:n.length)>0&&s(t.get(l.homepage)),(null===(i=l.seeAlso)||void 0===i?void 0:i.length)>0&&c(t.get(l.seeAlso)),(null===(a=l.rendering)||void 0===a?void 0:a.length)>0&&p(t.get(l.rendering)),(null===(o=l.thumbnail)||void 0===o?void 0:o.length)>0&&m(t.get(l.thumbnail)))},[e,t]),n)?(0,i.jsx)(es,{children:(0,i.jsxs)(el,{children:[(0,i.jsx)(eg,{thumbnail:h,label:n.label}),(0,i.jsx)(ef,{summary:n.summary}),(0,i.jsx)(eu,{metadata:n.metadata}),(0,i.jsx)(eh,{requiredStatement:n.requiredStatement}),(0,i.jsx)(em,{rights:n.rights}),(0,i.jsx)(ed,{homepage:l}),(0,i.jsx)(ev,{seeAlso:d}),(0,i.jsx)(ep,{rendering:u}),(0,i.jsx)(ec,{id:n.id,htmlLabel:"IIIF Manifest"})]})}):(0,i.jsx)(i.Fragment,{})},eb=e=>{var t,n,a,r,l,s;let{contentStateAnnotation:d}=e,{vault:u}=(0,o.D1)();if(!d)return(0,i.jsx)(i.Fragment,{});let p=(null==d?void 0:null===(t=d.target)||void 0===t?void 0:t.source)||(null==d?void 0:d.target),h=u.get(null==p?void 0:p.id),m=(0,c.G)(u,h.id),v=(null==m?void 0:null===(n=m[0])||void 0===n?void 0:n.service)?(null==m?void 0:null===(r=m[0])||void 0===r?void 0:null===(a=r.service[0])||void 0===a?void 0:a.id)||(null==m?void 0:null===(s=m[0])||void 0===s?void 0:null===(l=s.service[0])||void 0===l?void 0:l["@id"]):void 0;return(0,i.jsxs)(A,{"data-testid":"annotation-page",children:[h&&(0,i.jsxs)("header",{children:[(0,i.jsx)(K.__,{label:h.label})," ",(0,i.jsx)("em",{children:"(Shared)"})]}),(0,i.jsx)("div",{"data-testid":"annotation-page-items",children:(0,i.jsx)(Q,{annotation:d,targetResource:v,isContentState:!0},d.id)})]})},ey=e=>{var t,n;let{activeCanvas:r,annotationResources:l,searchServiceUrl:s,setContentSearchResource:d,contentSearchResource:c}=e,{t:u}=(0,ea.L)(),p=(0,o.Cu)(),{contentStateAnnotation:v,informationPanelResource:f,isAutoScrolling:g,isUserScrolling:x,vault:b,configOptions:y,plugins:j}=(0,o.D1)(),{informationPanel:I}=y,R=null==I?void 0:I.renderAbout,A=null==I?void 0:I.renderAnnotation,M=b.get({id:r,type:"Canvas"}),T=null==I?void 0:I.renderContentSearch,L=null==I?void 0:I.renderToggle,E=null==y?void 0:null===(t=y.annotations)||void 0===t?void 0:t.motivations,$=(null==v?void 0:null===(n=v.target)||void 0===n?void 0:n.source)||(null==v?void 0:v.target),P=!!v&&$.id===r,F=(0,a.useMemo)(()=>l?E?l.map(e=>{var t;if(!(null==e?void 0:null===(t=e.items)||void 0===t?void 0:t.length))return null;let n=e.items.filter(e=>{let t=b.get(e.id);return(0,X.bw)(t,E)});return n.length?{...e,items:n}:null}).filter(Boolean):l:[],[l,E,b]),H=!!(null==F?void 0:F.length)||P,{pluginsWithInfoPanel:D}=function(e){let t=[];return e.forEach(e=>{var n;(null===(n=e.informationPanel)||void 0===n?void 0:n.component)&&t.push(e)}),{pluginsWithInfoPanel:t}}(j);return(0,a.useEffect)(()=>{["manifest-about","manifest-annotations","manifest-content-search"].includes(String(null==I?void 0:I.defaultTab))?p({type:"updateInformationPanelResource",informationPanelResource:null==I?void 0:I.defaultTab}):P?p({type:"updateInformationPanelResource",informationPanelResource:"manifest-annotations"}):p({type:"updateInformationPanelResource",informationPanelResource:"manifest-about"})},[]),(0,a.useEffect)(()=>{H||p({type:"updateInformationPanelResource",informationPanelResource:"manifest-about"})},[H]),(0,i.jsxs)(w,{"data-testid":"information-panel",defaultValue:f,onValueChange:e=>{p({type:"updateInformationPanelResource",informationPanelResource:e})},orientation:"horizontal",value:f,className:"clover-viewer-information-panel",children:[(0,i.jsxs)(S,{"aria-label":u("informationPanelTabs"),"data-testid":"information-panel-list",children:[L&&(0,i.jsx)(C,{value:"manifest-back","data-value":"manifest-back",onClick:()=>{p({type:"updateInformationOpen",isInformationOpen:!1})},as:"button",children:u("informationPanelTabsClose")}),R&&(0,i.jsx)(C,{value:"manifest-about",children:u("informationPanelTabsAbout")}),T&&c&&(0,i.jsx)(C,{value:"manifest-content-search",children:u("informationPanelTabsSearch")}),A&&H&&(0,i.jsx)(C,{value:"manifest-annotations",children:(null==I?void 0:I.annotationTabLabel)||u("informationPanelTabsAnnotations")}),D&&D.map((e,t)=>{var n;return(0,i.jsx)(C,{value:e.id,children:(0,i.jsx)(K.__,{label:null===(n=e.informationPanel)||void 0===n?void 0:n.label})},t)})]}),(0,i.jsxs)(z,{handleScroll:function(){if(!g){clearTimeout(x);let e=setTimeout(()=>{p({type:"updateUserScrolling",isUserScrolling:void 0})},1500);p({type:"updateUserScrolling",isUserScrolling:e})}},children:[R&&(0,i.jsx)(k,{value:"manifest-about",children:(0,i.jsx)(ex,{})}),T&&c&&(0,i.jsx)(k,{value:"manifest-content-search",children:(0,i.jsx)(er,{searchServiceUrl:s,setContentSearchResource:d,activeCanvas:r,annotationPage:c})}),A&&H&&F&&(0,i.jsxs)(k,{value:"manifest-annotations",children:[v&&P&&(0,i.jsx)(eb,{contentStateAnnotation:v}),F.map(e=>(0,i.jsx)(ee,{annotationPage:e},e.id))]}),D&&D.map((e,t)=>(function(e,t){var n,a;let r=null==e?void 0:null===(n=e.informationPanel)||void 0===n?void 0:n.component;return void 0===r?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(k,{value:e.id,children:(0,i.jsx)(h.SV,{FallbackComponent:m.Z,children:(0,i.jsx)(r,{...null==e?void 0:null===(a=e.informationPanel)||void 0===a?void 0:a.componentProps,canvas:M,useViewerDispatch:o.Cu,useViewerState:o.D1})})},t)})(e,t))]})]})},ej=n(113);let ew=(0,v.zo)("span",{background:"transparent",opacity:"0",border:"3px solid transparent",position:"absolute",width:"100%",height:"100%",zIndex:"0",left:"0",top:"0",transition:"$all"}),eS=(0,v.zo)("span",{display:"flex"}),eC=(0,v.zo)("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),ek=(0,v.zo)("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),ez=(0,v.zo)("div",{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",".media-thumbnail-lazyload":{width:"100%",height:"100%",borderRadius:"3px"},img:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"top center",filter:"blur(0)",transform:"scale3d(1, 1, 1)",borderRadius:"3px",transition:"$all",color:"transparent"},["& ".concat(eS)]:{position:"absolute",right:"0",bottom:"0",["& ".concat(ej.Vp)]:{display:"none",margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}}),eI=(0,v.zo)(O.ck,{display:"flex",flexShrink:"0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left",figure:{margin:"0",width:"161.8px",figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}}}),eR=(0,v.zo)(O.fC,{display:"flex",flexDirection:"row",flexGrow:"1",overflowX:"scroll",position:"relative",zIndex:"0",gap:"1rem",padding:"1.618rem 0"}),eA=(0,v.zo)("div",{display:"flex",flexDirection:"row","&[data-active='true']":{["& ".concat(eI)]:{figcaption:{fontWeight:"700"},["& ".concat(ej.Vp)]:{backgroundColor:"$accent"},["& ".concat(ew)]:{background:"#0003",opacity:"1",borderBottom:"3px solid $accent"},"&:first-of-type":{["& ".concat(ew)]:{borderRight:"unset"}},"&:last-of-type":{["& ".concat(ew)]:{borderLeft:"unset"}}}},["& ".concat(eI)]:{["& ".concat(ez)]:{borderRadius:"unset"},"&:first-of-type":{["& ".concat(ez)]:{borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"}},"&:last-of-type":{["& ".concat(ez)]:{borderTopRightRadius:"3px",borderBottomRightRadius:"3px"},["& ".concat(ej.Vp)]:{display:"flex"}}}}),eM=(0,v.zo)("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),eT=(0,v.zo)("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0001","&::placeholder":{color:"$primaryMuted"}}),eL=(0,v.zo)("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),eE=(0,v.zo)("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem",fontWeight:"bold",gap:"0.25rem",em:{opacity:"0.25"}}}),e$=(0,v.zo)("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",["& ".concat(eM)]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}});var eP=(e,t)=>{(0,a.useEffect)(()=>{function n(n){n.key===e&&t()}return window.addEventListener("keyup",n),()=>window.removeEventListener("keyup",n)},[])};let eF=e=>{let{title:t}=e;return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})]})},eH=e=>{let{title:t}=e;return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})]})},eD=e=>{let{title:t}=e;return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})]})},eV=e=>{let{title:t}=e;return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})]})};var eN=e=>{let{handleCanvasToggle:t,handleFilter:n,activeIndex:o,canvasLength:r,isRtlPaged:l=!1}=e,[s,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1),{t:m}=(0,ea.L)();return(0,a.useEffect)(()=>{0===o?h(!0):h(!1),o===r-1?u(!0):u(!1)},[o,r]),eP("Escape",()=>{d(!1),n("")}),(0,i.jsx)(e$,{isToggle:s,className:"clover-viewer-media-controls",children:(0,i.jsxs)(eM,{children:[s&&(0,i.jsx)(eT,{autoFocus:!0,onChange:e=>n(e.target.value),placeholder:m("commonSearchPlaceholder")}),!s&&(0,i.jsx)(eE,{className:"clover-viewer-media-navigation","data-rtl-paged":l,children:l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eL,{onClick:()=>t(1),disabled:c,type:"button",children:(0,i.jsx)(eF,{title:m("commonNext")})}),(0,i.jsxs)("span",{children:[o+1," ",(0,i.jsx)("em",{children:"/"})," ",r]}),(0,i.jsx)(eL,{onClick:()=>t(-1),disabled:p,type:"button",children:(0,i.jsx)(eH,{title:m("commonPrevious")})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eL,{onClick:()=>t(-1),disabled:p,type:"button",children:(0,i.jsx)(eF,{title:m("commonPrevious")})}),(0,i.jsxs)("span",{children:[o+1," ",(0,i.jsx)("em",{children:"/"})," ",r]}),(0,i.jsx)(eL,{onClick:()=>t(1),disabled:c,type:"button",children:(0,i.jsx)(eH,{title:m("commonNext")})})]})}),(0,i.jsx)(eL,{onClick:()=>{d(e=>!e),n("")},type:"button",className:"clover-viewer-media-search",children:s?(0,i.jsx)(eD,{title:m("commonClose")}):(0,i.jsx)(eV,{title:m("commonSearch")})})]})})},eO=n(1446),eB=n(4610),e_=n(4131);let eW=e=>{let{type:t}=e;switch(t){case"Sound":return(0,i.jsx)(ej.JO.Audio,{});case"Image":default:return(0,i.jsx)(ej.JO.Image,{});case"Video":return(0,i.jsx)(ej.JO.Video,{})}};var eG=e=>{let{canvas:t,canvasIndex:n,isActive:r,type:l,handleChange:s}=e,[d,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(),{vault:h}=(0,o.D1)(),m=(null==t?void 0:t.label)?(0,eB.M)(null==t?void 0:t.label):String(n+1);return(0,a.useEffect)(()=>{d&&(async()=>{try{var e,n;if((null==t?void 0:null===(e=t.thumbnail)||void 0===e?void 0:e.length)!==0)p(null==t?void 0:null===(n=t.thumbnail[0])||void 0===n?void 0:n.id);else{let{best:e}=await (0,e_.sX)(t,{vault:h,dereference:!0,width:200,height:200});p(null==e?void 0:e.id)}}catch(e){console.error("Error fetching thumbnail",e)}})()},[t,d]),(0,i.jsx)(eI,{"aria-checked":r,"data-testid":"media-thumbnail","data-canvas":n,onClick:()=>s(t.id),value:t.id,children:(0,i.jsxs)("figure",{children:[(0,i.jsxs)(ez,{children:[(0,i.jsx)(eO.Z,{isVisibleCallback:e=>{c(e)},attributes:{className:"media-thumbnail-lazyload","data-lazyload":String(d),"data-testid":"media-thumbnail-lazyload"},children:u&&(0,i.jsx)("img",{alt:m,"data-testid":"media-thumbnail-image",src:u})}),(0,i.jsx)(ew,{}),(0,i.jsx)(eS,{children:(0,i.jsxs)(ej.Vp,{isIcon:!0,"data-testid":"thumbnail-tag",children:[(0,i.jsx)(eC,{}),(0,i.jsx)(ej.JO,{"aria-label":l,children:(0,i.jsx)(eW,{type:l})}),["Video","Sound"].includes(l)&&(0,i.jsx)(ek,{children:(0,W.rJ)(t.duration)})]})})]}),(0,i.jsx)("figcaption",{"data-testid":"fig-caption",children:t.label?(0,i.jsx)(K.__,{label:t.label}):(n+1).toString()})]})})},eJ=n(768);let eq=e=>e.body?e.body.type:"Image";var eZ=e=>{let{items:t}=e,{t:n}=(0,ea.L)(),r=(0,o.Cu)(),{activeCanvas:l,isPaged:s,vault:d,sequence:c,viewingDirection:u}=(0,o.D1)(),p=s&&"right-to-left"===u,[h,m]=(0,a.useState)(""),[v,f]=(0,a.useState)([]),[g,x]=(0,a.useState)(0),b=a.useRef(null),y=e=>{l!==e&&r({type:"updateActiveCanvas",canvasId:e})};return(0,a.useEffect)(()=>{if(!v.length){let e=["Image","Sound","Video"];f(t.map(t=>(0,eJ.g)(d,t,"painting",e)).filter(e=>e.annotations.length>0))}},[t,v.length,d]),(0,a.useEffect)(()=>{v.forEach((e,t)=>{(null==e?void 0:e.canvas)&&e.canvas.id===l&&x(t)})},[l,v]),(0,a.useEffect)(()=>{let e=document.querySelector('[data-canvas="'.concat(g,'"]'));if(e instanceof HTMLElement&&b.current){let t=e.offsetLeft-b.current.offsetWidth/2+e.offsetWidth/2;b.current.scrollTo({left:t,behavior:"smooth"})}},[g]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eN,{handleFilter:e=>m(e),handleCanvasToggle:e=>{let t=c[1].findIndex(e=>e.includes(g)),n=t+e>=0?t+e:c[1].length-1;if(!c[1][n])return;let i=c[1][n][0],a=c[0][i].id;a&&y(a)},activeIndex:g,canvasLength:t.length,isRtlPaged:p}),(0,i.jsx)(eR,{"aria-label":n("media.selectItem"),"data-testid":"media","data-active-canvas":t[g].id,"data-canvas-length":t.length,"data-filter":h,"data-rtl-paged":p,ref:b,style:{direction:p?"rtl":"ltr"},children:c[1].filter(e=>e.some(e=>{var t;let n=c[0][e].id,i=v.find(e=>{var t;return(null==e?void 0:null===(t=e.canvas)||void 0===t?void 0:t.id)===n});if(!i)return!1;let a=(0,eB.M)(null==i?void 0:null===(t=i.canvas)||void 0===t?void 0:t.label)||"";return!h||!!a.toLowerCase().includes(h.toLowerCase())})).map((e,t)=>{let n=e.map(e=>c[0][e].id).includes(l);return(0,i.jsx)(eA,{"data-active":n,children:e.map(e=>{var t,n;let a=c[0][e].id,o=v.find(e=>{var t;return(null==e?void 0:null===(t=e.canvas)||void 0===t?void 0:t.id)===a});return o?(0,i.jsx)(eG,{canvas:o.canvas,canvasIndex:v.findIndex(e=>e===o),handleChange:y,isActive:l===(null==o?void 0:null===(t=o.canvas)||void 0===t?void 0:t.id),type:eq(o.annotations[0])},null==o?void 0:null===(n=o.canvas)||void 0===n?void 0:n.id):null})},t)})})]})};let eU=(0,v.zo)("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all",opacity:1,display:"flex",alignItems:"center",justifyContent:"center",img:{width:"100%",height:"100%",objectFit:"contain",color:"transparent",aspectRatio:"auto"},"&[data-paged=true]":{"img:first-child ":{objectPosition:"100% 50%"},"img:last-child":{objectPosition:"0 50%"}},"&[data-active=false]":{opacity:0,objectPosition:"50% 50%"},variants:{isMedia:{true:{cursor:"pointer"}}}});var eY=n(2239);let eX=(0,v.zo)(eY.c,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),eQ=(0,v.zo)("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{["".concat(eX)]:{backgroundColor:"$accent"},["".concat(eU)]:{backgroundColor:"#6662"}}}),eK=(0,v.zo)("div",{width:"100%",height:"100%"});var e0=n(3952);let e1=(0,v.zo)("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),e2=(0,v.zo)(e0.xz,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),e4=(0,v.zo)(e0.VY,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),e3=(0,v.zo)(e0.ck,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),e5=(0,v.zo)(e0.__,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),e6=(0,v.zo)(e0.fC,{position:"relative",zIndex:"5",width:"100%"});var e8=e=>{let{direction:t,title:n}=e;return(0,i.jsxs)(e1,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img",children:[(0,i.jsx)("title",{children:n}),"up"===t&&(0,i.jsx)(()=>(0,i.jsx)("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),{}),"down"===t&&(0,i.jsx)(()=>(0,i.jsx)("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"}),{})]})},e7=e=>{let{children:t,label:n,maxHeight:a,onValueChange:o,value:r}=e;return(0,i.jsxs)(e6,{onValueChange:o,value:r,children:[(0,i.jsxs)(e2,{"data-testid":"select-button",children:[(0,i.jsx)(e0.ki,{"data-testid":"select-button-value"}),(0,i.jsx)(e0.GV,{children:(0,i.jsx)(e8,{direction:"down",title:"select"})})]}),(0,i.jsx)(e0.ue,{children:(0,i.jsxs)(e4,{css:{maxHeight:"".concat(a," !important")},"data-testid":"select-content",children:[(0,i.jsx)(e0.Pn,{children:(0,i.jsx)(e8,{direction:"up",title:"scroll up for more"})}),(0,i.jsx)(e0.Q_,{children:(0,i.jsxs)(e0.DI,{children:[n&&(0,i.jsx)(e5,{children:(0,i.jsx)(K.__,{"data-testid":"select-label",label:n})}),t]})}),(0,i.jsx)(e0.Jk,{children:(0,i.jsx)(e8,{direction:"down",title:"scroll down for more"})})]})})]})},e9=e=>(0,i.jsxs)(e3,{...e,children:[e.thumbnail&&(0,i.jsx)(K.pl,{thumbnail:e.thumbnail}),(0,i.jsx)(e0.S_,{children:(0,i.jsx)(K.__,{label:e.label})}),(0,i.jsx)(e0.o6,{})]}),te=n(9788),tt=e=>{let{isActive:t,isMedia:n,items:r,setIsInteractive:l}=e,{vault:s}=(0,o.D1)(),[d,u]=(0,a.useState)([]),p=d.length>1;if((0,a.useEffect)(()=>{u([]);let e=r.map(e=>{let t=(0,c.G)(s,e.id);if(!t)return null;let{id:n,width:i,height:a}=t[0];return n?{src:n,width:i||640,height:a||640,alt:e.label?U(e.label):"placeholder image"}:null}).filter(e=>null!==e);e.length&&u(e)},[r,p]),!t||!d.length)return null;let h=d.map(e=>e.width/e.height*1),m=h.reduce((e,t)=>e+t,0);return(0,i.jsx)(eU,{onClick:()=>l(!0),isMedia:n,className:"clover-viewer-placeholder","data-active":t,"data-paged":p,children:d.map((e,t)=>{let n=h[t]/m*100;return(0,a.createElement)("img",{...e,key:t,alt:e.alt,style:{width:"".concat(n,"%")}})})})},tn=n(3041);let ti=(0,v.zo)("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),ta=a.forwardRef((e,t)=>{let n=a.useRef(null),o=(0,a.useCallback)(()=>{var e,i;if((null===(e=t.current)||void 0===e?void 0:e.currentTime)&&(null===(i=t.current)||void 0===i?void 0:i.currentTime)>0)return;let a=t.current;if(!a)return;let o=new AudioContext,r=o.createMediaElementSource(a),l=o.createAnalyser(),s=n.current;if(!s)return;s.width=a.offsetWidth,s.height=a.offsetHeight;let d=s.getContext("2d");r.connect(l),l.connect(o.destination),l.fftSize=256;let c=l.frequencyBinCount,u=new Uint8Array(c);setInterval(function(){!function(e,t,n,i,a,o){let r;let l=a/n*2.6,s=0;e.getByteFrequencyData(i),t.fillStyle="#000000",t.fillRect(0,0,a,o);for(let e=0;e<n;e++)r=2*i[e],t.fillStyle="rgba(".concat(78,", 42, 132, 1)"),t.fillRect(s,o-r,l,r),s+=l+6}(l,d,c,u,s.width,s.height)},20)},[t]);return a.useEffect(()=>{t&&t.current&&(t.current.onplay=o)},[o,t]),(0,i.jsx)(ti,{ref:n,role:"presentation"})}),to=(0,v.zo)("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}});var tr=e=>{let{resource:t,ignoreCaptionLabels:n}=e,a=U(t.label,"en");return Array.isArray(a)&&a.some(e=>n.includes(e))?null:(0,i.jsx)("track",{src:t.id,label:Array.isArray(a)?a[0]:a,srcLang:"en","data-testid":"player-track"},t.id)};let tl=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];var ts=e=>{let{allSources:t,annotationResources:n,painting:r}=e,[l,s]=a.useState(0),[d,u]=a.useState(),p=a.useRef(null),h=(null==r?void 0:r.type)==="Sound",m=(0,o.Cu)(),{activeCanvas:v,configOptions:f,contentStateAnnotation:g,vault:x}=(0,o.D1)();return(0,a.useEffect)(()=>{if(!r.id||!p.current)return;if(null==p?void 0:p.current){let e=p.current;m({type:"updateActivePlayer",player:e}),e.src=r.id,e.load()}if("m3u8"!==r.id.split(".").pop()&&r.format&&!tl.includes(r.format))return;let e=new tn.ZP({xhrSetup:function(e,t){e.withCredentials=!!f.withCredentials}});return e.attachMedia(p.current),e.on(tn.ZP.Events.MEDIA_ATTACHED,function(){e.loadSource(r.id)}),e.on(tn.ZP.Events.ERROR,function(t,n){if(n.fatal)switch(n.type){case tn.ZP.ErrorTypes.NETWORK_ERROR:console.error("fatal ".concat(t," network error encountered, try to recover")),e.startLoad();break;case tn.ZP.ErrorTypes.MEDIA_ERROR:console.error("fatal ".concat(t," media error encountered, try to recover")),e.recoverMediaError();break;default:e.destroy()}}),()=>{if(e&&p.current){let t=p.current;e.detachMedia(),e.destroy(),t.currentTime=0}}},[f.withCredentials,r.id,r.format,m]),(0,a.useEffect)(()=>{var e,t,n,i;let a=x.get(v),o=(null===(e=a.accompanyingCanvas)||void 0===e?void 0:e.id)?(0,c.G)(x,null===(t=a.accompanyingCanvas)||void 0===t?void 0:t.id):null,r=(null===(n=a.placeholderCanvas)||void 0===n?void 0:n.id)?(0,c.G)(x,null===(i=a.placeholderCanvas)||void 0===i?void 0:i.id):null;o&&r?0===l?u(r[0].id):u(o[0].id):(o&&u(o[0].id),r&&u(r[0].id))},[v,l,x]),(0,a.useEffect)(()=>{let e=null==p?void 0:p.current;if(!e)return;let t=null,n=!1,i=()=>{n||(n=!0,t=setInterval(()=>{!e||e.paused||e.ended||(s(e.currentTime),m({type:"updateActiveSelector",selector:{type:"PointSelector",t:Math.round(e.currentTime)}}))},500)),e&&e.paused&&(s(e.currentTime),m({type:"updateActiveSelector",selector:{type:"PointSelector",t:Math.round(e.currentTime)}}))};return e.addEventListener("timeupdate",i),()=>{null==e||e.removeEventListener("timeupdate",i),t&&clearInterval(t)}},[r.id,v]),(0,a.useEffect)(()=>{if(g){var e,t;let n=null==p?void 0:p.current;if(!n)return;let{type:i,t:a,value:o}=(null==g?void 0:null===(e=g.target)||void 0===e?void 0:e.selector)||{};if(((null==g?void 0:null===(t=g.target)||void 0===t?void 0:t.source)||(null==g?void 0:g.target)).id===v&&(a&&"PointSelector"===i&&(s(a),n.currentTime=a),"FragmentSelector"===i&&o)){let e=o.split("=")[1];if(!e)return;let t=e.split(",")[0];s(t),n.currentTime=t}}},[p,g]),(0,i.jsxs)(to,{css:{backgroundColor:f.canvasBackgroundColor,maxHeight:f.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper",children:[(0,i.jsxs)("video",{id:"clover-iiif-video",ref:p,"data-src":r.id,controls:!0,height:r.height,width:r.width,crossOrigin:f.crossOrigin,poster:d,style:{maxHeight:f.canvasHeight,position:"relative",zIndex:"1"},children:[t.map(e=>(0,i.jsx)("source",{src:e.id,type:e.format},e.id)),(null==n?void 0:n.length)>0&&n.map(e=>{let t=[];return e.items.forEach(e=>{x.get(e.id).body.forEach(e=>{let n=x.get(e.id);t.push(n)})}),t.map(e=>(0,i.jsx)(tr,{resource:e,ignoreCaptionLabels:f.ignoreCaptionLabels||[]},e.id))}),"Sorry, your browser doesn't support embedded videos."]},r.id),h&&(0,i.jsx)(ta,{ref:p})]})};let td=e=>{let{label:t}=e;return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img",children:[(0,i.jsx)("title",{id:"close-svg-title",children:t}),(0,i.jsx)("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})]})},tc=e=>{let{isMedia:t,label:n}=e;return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img",children:[(0,i.jsx)("title",{id:"open-svg-title",children:n}),t?(0,i.jsx)("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),(0,i.jsx)("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"})]})]})};var tu=e=>{let{handleToggle:t,isInteractive:n,isMedia:a}=e,{t:o}=(0,ea.L)();return(0,i.jsx)(eX,{onClick:t,isInteractive:n,isMedia:a,"data-testid":"placeholder-toggle",children:n?(0,i.jsx)(td,{label:o("commonClose")}):(0,i.jsx)(tc,{isMedia:a,label:o("commonOpen")})})},tp=e=>{var t,n,r,l;let{activeCanvas:s,annotationResources:d,contentSearchResource:u,isMedia:p,painting:h}=e,[m,v]=a.useState(0),[f,g]=a.useState(!1),[x,b]=a.useState([]),[y,j]=a.useState([]),[w,S]=a.useState(0),{configOptions:C,customDisplays:k,contentStateAnnotation:z,informationPanelResource:I,isPaged:R,openSeadragonViewer:A,vault:M,viewerId:T,viewingDirection:L,visibleCanvases:E}=(0,o.D1)(),$=R&&"right-to-left"===L,[P,F]=a.useState([]),H=!!z&&s===(null==z?void 0:null===(n=z.target)||void 0===n?void 0:null===(t=n.source)||void 0===t?void 0:t.id),D=(0,o.Cu)(),V=M.get(s),N=y.length&&!f&&!p,O=(null==h?void 0:h.length)>1,B="".concat(T,"-").concat((0,W.un)(s+m+JSON.stringify(E)+w)),_=()=>{g(!f),S(e=>e+1)},G=k.find(e=>{let t=!1,{canvasId:n,paintingFormat:i}=e.target;if(Array.isArray(n)&&n.length>0&&(t=n.includes(s)),Array.isArray(i)&&i.length>0){var a;let e=(null===(a=h[m])||void 0===a?void 0:a.format)||"";t=!!(e&&i.includes(e))}return t});(0,a.useEffect)(()=>{H&&N&&0===w&&_()},[H,N]),(0,a.useEffect)(()=>{N&&(D({type:"updateOpenSeadragonViewer",openSeadragonViewer:void 0}),D({type:"updateActiveSelector",selector:void 0}))},[N]),(0,a.useEffect)(()=>{var e,t,n;let i=[];if("manifest-annotations"===I&&(null==d||d.forEach((e,t)=>{var n;null==e||null===(n=e.items)||void 0===n||n.forEach(e=>{let n=M.get(e.id);n&&i.push({annotation:{...n,body:n.body.map(e=>M.get(e.id)||e)},targetIndex:t})})}),z)){let n=(null==z?void 0:null===(e=z.target)||void 0===e?void 0:e.source)||(null==z?void 0:z.target);i.push({annotation:{...z,body:null==z?void 0:null===(t=z.body)||void 0===t?void 0:t.map(e=>M.get(e.id)||e)},targetIndex:E.findIndex(e=>e.id===n.id)})}"manifest-content-search"===I&&(null==u||null===(n=u.items)||void 0===n||n.forEach(e=>{let t=M.get(e.id);if(t){let e=E.findIndex(e=>e.id===t.target.source.id);"number"==typeof e&&i.push({annotation:{...t,body:t.body.map(e=>M.get(e.id)||e)},targetIndex:e})}})),F(i)},[d,u,z,I,E]),(0,a.useEffect)(()=>{if(!p){let e=$?[...E].reverse():E,t=e.map(e=>{let t=e.id,n=(0,c.G)(M,t);return n?n[m]:void 0}).filter(Boolean),n=e.map(e=>{var t;let n=e.id,i=M.get(n),a=null==i?void 0:null===(t=i.placeholderCanvas)||void 0===t?void 0:t.id;return a&&a?{id:a,label:null==i?void 0:i.label}:null}).filter(e=>null!==e);b(t),j(n)}},[m,s,$,E,p,V]),(0,a.useEffect)(()=>{v(0)},[E]);let J=null==G?void 0:null===(r=G.display)||void 0===r?void 0:r.component;return(0,i.jsxs)(eQ,{className:"clover-viewer-painting",children:[(0,i.jsxs)(eK,{style:{backgroundColor:C.canvasBackgroundColor,height:"auto"===C.canvasHeight?"100%":C.canvasHeight},children:[!!y.length&&!p&&(0,i.jsx)(tu,{handleToggle:_,isInteractive:f,isMedia:p}),!!(null==y?void 0:y.length)&&!p&&(0,i.jsx)(tt,{isActive:!!N,isMedia:p,items:y,setIsInteractive:g}),!N&&!G&&(p?(0,i.jsx)(ts,{allSources:h,painting:h[m],annotationResources:d}):h&&(0,i.jsx)(te.default,{_cloverViewerHasPlaceholder:!!(null==y?void 0:y.length),annotations:P,body:x,instanceId:B,openSeadragonCallback:e=>{e&&!N&&(null==A?void 0:A.id)!=="openseadragon-".concat(B)&&D({type:"updateOpenSeadragonViewer",openSeadragonViewer:e})},openSeadragonConfig:C.openSeadragon},B)),!N&&J&&(0,i.jsx)(J,{id:s,annotationBody:h[m],hooks:{useViewerDispatch:o.Cu,useViewerState:o.D1},...null==G?void 0:G.display.componentProps})]}),O&&(0,i.jsx)(e7,{value:null===(l=h[m])||void 0===l?void 0:l.id,onValueChange:e=>{v(h.findIndex(t=>t.id===e))},maxHeight:"200px",children:null==h?void 0:h.map(e=>(0,i.jsx)(e9,{value:null==e?void 0:e.id,label:null==e?void 0:e.label},null==e?void 0:e.id))})]})},th=e=>{var t,n;let{activeCanvas:a,annotationResources:r,searchServiceUrl:l,setContentSearchResource:s,contentSearchResource:d,isAudioVideo:c,items:u,painting:p}=e,{contentStateAnnotation:h,isInformationOpen:m,configOptions:v,sequence:y,visibleCanvases:j}=(0,o.D1)(),{informationPanel:w}=v,S=j.map(e=>e.id),C=(r.length>0||S.includes(null==h?void 0:null===(n=h.target)||void 0===n?void 0:null===(t=n.source)||void 0===t?void 0:t.id))&&(null==w?void 0:w.renderAnnotation)&&(null==w?void 0:w.renderToggle)===!1&&m,k=(null==w?void 0:w.renderAbout)&&m||C,z=null==w?void 0:w.renderToggle;return(0,i.jsxs)(g,{className:"clover-viewer-content","data-testid":"clover-viewer-content",children:[(0,i.jsxs)(x,{"data-aside-active":k,"data-aside-toggle":z,children:[(0,i.jsx)(tp,{activeCanvas:a,annotationResources:r,contentSearchResource:d,isMedia:c,painting:p}),y[1].length>1&&(0,i.jsx)(f,{className:"clover-viewer-media-wrapper",children:(0,i.jsx)(eZ,{items:u,activeItem:0})})]}),k&&(0,i.jsx)(b,{"data-aside-active":k,"data-aside-toggle":z,children:(0,i.jsx)(ey,{activeCanvas:a,annotationResources:r,searchServiceUrl:l,setContentSearchResource:s,contentSearchResource:d})})]})};let tm=(0,v.zo)(ej.J2.Trigger,{width:"30px",padding:"5px"}),tv=(0,v.zo)(ej.J2.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),tf=(0,v.zo)("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),tg=(0,v.zo)("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",["> ".concat(e6)]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),tx=(0,v.zo)("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"});var tb=()=>{var e;let t=(0,o.Cu)(),{activeManifest:n,collection:a,configOptions:r,vault:l}=(0,o.D1)(),s=null==r?void 0:r.canvasHeight;return(0,i.jsx)("div",{style:{margin:"0.75rem"},children:(0,i.jsx)(e7,{label:a.label,maxHeight:s,value:n,onValueChange:e=>{t({type:"updateActiveCanvas",canvasId:void 0}),t({type:"updateActiveManifest",manifestId:e}),t({type:"updateViewerId",viewerId:(0,D.Z)()})},children:null==a?void 0:null===(e=a.items)||void 0===e?void 0:e.map(e=>(0,i.jsx)(e9,{value:e.id,thumbnail:(null==e?void 0:e.thumbnail)?l.get(null==e?void 0:e.thumbnail):void 0,label:e.label},e.id))})})};let ty=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500,{t:n}=(0,ea.L)(),[i,o]=(0,a.useState)(""),r=(0,a.useCallback)(()=>{navigator.clipboard.writeText(e).then(()=>o(n("copySuccess")),()=>o(n("copyFailure")))},[n,e]);return(0,a.useEffect)(()=>{if(!i)return;let e=setTimeout(()=>o(""),t);return()=>clearTimeout(e)},[i,t]),[i,r]},tj=(0,v.zo)("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",lineHeight:"1em"}),tw=e=>{let{status:t}=e;return t?(0,i.jsx)(tj,{"data-copy-status":t,children:t}):null};var tS=e=>{let{textPrompt:t,textToCopy:n}=e,[a,o]=ty(n);return(0,i.jsxs)("button",{onClick:o,children:[t," ",(0,i.jsx)(tw,{status:a})]})},tC=e=>{let{title:t}=e,n="#ed1d33",a="#2873ab";return(0,i.jsxs)("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1",children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)",children:(0,i.jsxs)("g",{transform:"scale(0.1)",children:[(0,i.jsx)("path",{style:{fill:a},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),(0,i.jsx)("path",{style:{fill:a},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),(0,i.jsx)("path",{style:{fill:n},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),(0,i.jsx)("path",{style:{fill:n},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),(0,i.jsx)("path",{style:{fill:a},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),(0,i.jsx)("path",{style:{fill:a},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),(0,i.jsx)("path",{style:{fill:n},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"})]})})]})},tk=n(761);let tz=(0,v.zo)(tk.fC,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),tI=(0,v.zo)(tk.bU,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",span:{fontFamily:"monospace",fontSize:"0.8333rem",fontWeight:"700",display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center",color:"$primary",opacity:"0.382",userSelect:"none",pointerEvents:"none"},'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))",span:{opacity:"1",color:"$accent"}}});(0,v.zo)("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"});let tR=(0,v.zo)("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"});var tA=a.memo(()=>{let{isInformationOpen:e}=(0,o.D1)(),t=(0,o.Cu)(),{t:n}=(0,ea.L)();return(0,i.jsx)(tR,{children:(0,i.jsx)(tz,{checked:e,onCheckedChange:e=>{t({type:"updateInformationOpen",isInformationOpen:e})},id:"information-toggle","aria-label":n("informationPanelToggle"),name:"toggled?",children:(0,i.jsx)(tI,{children:(0,i.jsx)("span",{children:"i"})})})})});let tM=(0,v.zo)(ej.J2.Trigger,{width:"30px",padding:"5px",marginBottom:"auto"}),tT=(0,v.zo)(tv,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});var tL=n(226);function tE(e,t){let n=[];if(!e)return n;for(let i of e)if(i.id){let e=t.get(i.id);e&&n.push(e)}return n}function t$(e,t){return e.map(e=>{let{format:n,id:i,label:a}=e;return{format:n,id:function(e){let{vault:t}=(0,o.D1)();try{let n=e&&t.get(e);if(!n)throw Error("Vault entity ".concat(e," not found."));return(null==n?void 0:n["@id"])||(null==n?void 0:n.id)}catch(t){return console.error(t),e}}(i),label:(0,eB.M)(a)||t}})}var tP=()=>{let{allPages:e,individualPages:t}=function(){let e=function(){let{activeCanvas:e,activeManifest:t,vault:n}=(0,o.D1)(),[i,r]=(0,a.useState)({root:[],canvas:[]});return(0,a.useEffect)(()=>{let i=n.get(t),a=n.get(e),o=null==i?void 0:i.rendering,l=null==a?void 0:a.rendering;r({root:tE(o,n),canvas:tE(l,n)})},[e,t,n]),{...i}}();return{allPages:t$((null==e?void 0:e.root)||[],"Root Rendering Label"),individualPages:t$((null==e?void 0:e.canvas)||[],"Canvas Rendering Label")}}(),n=e.length>0||t.length>0,r=e=>{window.open(e,"_blank")};return n?(0,i.jsxs)(ej.J2,{children:[(0,i.jsx)(tM,{"data-testid":"download-button",children:(0,i.jsx)(tL.J,{children:(0,i.jsx)(tL.J.Download,{})})}),(0,i.jsxs)(tT,{"data-testid":"download-content",children:[t.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:"Individual Pages"}),(0,i.jsx)("ul",{children:t.map(e=>{let{format:t,id:n,label:a}=e;return(0,i.jsx)("li",{children:(0,i.jsxs)("button",{onClick:()=>r(n),children:[a," (",t,")"]})},a)})})]}),e.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:"All Pages"}),(0,i.jsx)("ul",{children:e.map(e=>{let{format:t,id:n,label:a}=e;return(0,i.jsx)("li",{children:(0,i.jsxs)("button",{onClick:()=>r(n),children:[a," (",t,")"]})},a)})})]})]})]}):null},tF=e=>{let{manifestId:t,manifestLabel:n}=e,{collection:a,configOptions:r}=(0,o.D1)(),{informationPanel:l,showDownload:s,showIIIFBadge:d,showTitle:c}=r,u=s||d||(null==l?void 0:l.renderToggle),{t:p}=(0,ea.L)();return(0,i.jsxs)(tg,{className:"clover-viewer-header",children:[(null==a?void 0:a.items)?(0,i.jsx)(tb,{}):(0,i.jsx)(tf,{className:c?"":"visually-hidden",children:c&&(0,i.jsx)(K.__,{label:n,className:"label"})}),u&&(0,i.jsxs)(tx,{children:[s&&(0,i.jsx)(tP,{}),d&&(0,i.jsxs)(ej.J2,{children:[(0,i.jsx)(tm,{children:(0,i.jsx)(tC,{title:p("commonShare")})}),(0,i.jsxs)(tv,{children:[(null==a?void 0:a.items)&&(0,i.jsx)("button",{onClick:e=>{e.preventDefault(),window.open(a.id,"_blank")},children:p("shareCollectionJson")}),(0,i.jsx)("button",{onClick:e=>{e.preventDefault(),window.open(t,"_blank")},children:p("shareManifestJson")})," ",(null==a?void 0:a.items)&&(0,i.jsx)(tS,{textPrompt:p("shareCollectionCopy"),textToCopy:a.id}),(0,i.jsx)(tS,{textPrompt:p("shareManifestCopy"),textToCopy:t})]})]}),(null==l?void 0:l.renderToggle)&&(0,i.jsx)(tA,{})]})]})};let tH=e=>{let t=()=>!!window.matchMedia&&window.matchMedia(e).matches,[n,i]=(0,a.useState)(t);return(0,a.useEffect)(()=>{let e=()=>i(t);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),n};var tD=e=>{var t;let{manifest:n,theme:r,iiifContentSearchQuery:s}=e,f=(0,o.D1)(),g=(0,o.Cu)(),{activeCanvas:x,isInformationOpen:b,vault:j,configOptions:w,visibleCanvases:S}=f,C=(null==w?void 0:w.canvasHeight)&&["100%","auto"].includes(null==w?void 0:w.canvasHeight),[k,z]=(0,a.useState)(!1),[I,R]=(0,a.useState)([]),[A,M]=(0,a.useState)([]),[T,L]=(0,a.useState)(),E=tH(v.BC.sm),[$,P]=(0,a.useState)(),F=(0,a.useCallback)(e=>{g({type:"updateInformationOpen",isInformationOpen:e})},[g]);(0,a.useEffect)(()=>{var e;(null==w?void 0:null===(e=w.informationPanel)||void 0===e?void 0:e.open)&&F(!E)},[E,null==w?void 0:null===(t=w.informationPanel)||void 0===t?void 0:t.open]),(0,a.useEffect)(()=>{},[E]),(0,a.useEffect)(()=>{let e=(0,c.G)(j,x);e&&(z(["Sound","Video"].indexOf(e[0].type)>-1),R(e)),g({type:"updateVisibleCanvases",visibleCanvases:(0,l.sA)(j,n,x)})},[x,E,n,j,g]),(0,a.useEffect)(()=>{(async()=>{M((await Promise.all(S.map(e=>u(j,e.id)))).flat())})()},[S]);let H=n.service.some(e=>["SearchService1","SearchService2"].includes(e.type||e["@type"]));return(0,a.useEffect)(()=>{if(H){let e=n.service.find(e=>["SearchService1","SearchService2"].includes(e.type||e["@type"]));e&&P(e.id||e["@id"])}},[n,H]),(0,a.useEffect)(()=>{var e;$&&(null===(e=w.informationPanel)||void 0===e?void 0:e.renderContentSearch)!==!1&&p(j,$,s).then(e=>L(e))},[$]),(0,i.jsx)(h.SV,{FallbackComponent:m.Z,children:(0,i.jsx)(y,{className:"".concat(r," clover-viewer"),css:{background:null==w?void 0:w.background},"data-absolute-position":C,"data-information-panel-open":b,children:(0,i.jsxs)(d.fC,{open:b,onOpenChange:F,children:[(0,i.jsx)(tF,{manifestLabel:n.label,manifestId:n.id}),(0,i.jsx)(th,{activeCanvas:x,painting:I,annotationResources:A,searchServiceUrl:$,setContentSearchResource:L,contentSearchResource:T,items:n.items,isAudioVideo:k})]})})})},tV=n(6744);let tN={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function tO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{ok:!1,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),data:t||e.statusText,json:()=>JSON.parse(t||e.statusText)}}var tB=n(9626);let t_={"@context":"http://iiif.io/api/presentation/3/context.json",id:"https://example.org/iiif/content-state/specific-resource",type:"Annotation",motivation:["contentState"],target:{type:"SpecificResource",source:{id:"https://example.org/iiif/manifest/canvas/0",type:"Canvas",partOf:[{id:"https://example.org/iiif/manifest",type:"Manifest"}]}},body:[]},tW=e=>{let{canvasIdCallback:t,contentStateCallback:n,customTheme:s,iiifContent:d,options:c,iiifContentSearchQuery:u}=e,p=(0,o.Cu)(),{activeCanvas:h,activeManifest:m,activeSelector:v,isLoaded:f,vault:g,visibleCanvases:x}=(0,o.D1)(),[b,y]=(0,a.useState)(),[j,w]=(0,a.useState)(),S={};if(s&&(S=(0,tV.jG)("custom",s)),(0,a.useEffect)(()=>{p({type:"updateActiveSelector",selector:void 0})},[h,m]),(0,a.useEffect)(()=>{if(t&&t(h),n&&m&&h){var e;let t=(null===(e=x[0])||void 0===e?void 0:e.id)||h,i="".concat(m,"/state/").concat((0,W.un)(t+JSON.stringify(v))),a={...t_,id:i,target:{type:"SpecificResource",source:{id:t,type:"Canvas",partOf:[{id:m,type:"Manifest"}]},selector:v}};n({json:a,encoded:(0,r.ML)(JSON.stringify(a))})}},[h,m,v,t,n,x]),(0,a.useEffect)(()=>{m&&g.load(m).then(e=>{if(!e)return;w(e);let t=(0,l.rw)(g,e);p({type:"updateActiveCanvas",canvasId:h||(0,tB.FO)(e)}),p({type:"updateManifestSequence",sequence:t});let n=e.viewingDirection||"left-to-right",i=e.behavior||[],a=Array.isArray(i)?i.includes("paged"):"paged"===i;p({type:"updateViewingDirection",viewingDirection:n}),p({type:"updateIsPaged",isPaged:a})}).catch(e=>{console.error("Manifest failed to load: ".concat(e))}).finally(()=>{p({type:"updateIsLoaded",isLoaded:!0})})},[d,m,p,g]),(0,a.useEffect)(()=>{p({type:"updateConfigOptions",configOptions:c}),(async()=>{if(!d)return;let e=(0,tB.Vu)(d);try{let t="object"==typeof e&&(null==e?void 0:e.id)?await g.loadSync(null==e?void 0:e.id,e):await g.load(e);y(t)}catch(n){var t;if(e&&e.id||console.error("Failed to load resource: ".concat(n)),(null==e?void 0:e.id)&&(null==e?void 0:e.type)==="Annotation"&&(null==e?void 0:null===(t=e.motivation)||void 0===t?void 0:t.includes("contentState"))){let t=await g.loadSync(e.id,e);t&&y(t)}else(null==e?void 0:e.id)&&["Canvas","Manifest"].includes(null==e?void 0:e.type)&&await g.loadSync(e.id,e)&&y({...t_,target:e})}})()},[p,d,c,g]),(0,a.useEffect)(()=>{if(b)switch(b.type){case"Annotation":if((null==b?void 0:b.motivation)&&(Array.isArray(null==b?void 0:b.motivation)?null==b?void 0:b.motivation.includes("contentState"):(null==b?void 0:b.motivation)==="content-state")){let{active:e}=(0,tB.jp)(b);p({type:"updateActiveManifest",manifestId:e.manifest}),p({type:"updateActiveCanvas",canvasId:e.canvas}),p({type:"updateContentStateAnnotation",contentStateAnnotation:b})}break;case"Collection":let e=(0,tB.nG)(b);p({type:"updateCollection",collection:b}),e&&p({type:"updateActiveManifest",manifestId:e});break;case"Manifest":p({type:"updateActiveManifest",manifestId:b.id})}},[p,d,b]),!f){if(null==c||!c.customLoadingComponent)return(0,i.jsx)(i.Fragment,{children:"Loading"});{let e=c.customLoadingComponent;return(0,i.jsx)(e,{})}}return j&&j.items?0===j.items.length?(console.log("The IIIF manifest ".concat(d," does not contain canvases.")),(0,i.jsx)(i.Fragment,{})):(0,i.jsx)(tD,{manifest:j,theme:S,iiifContentSearchQuery:u},j.id):(console.log("The IIIF manifest ".concat(d," failed to load.")),(0,i.jsx)(i.Fragment,{}))};var tG=e=>{var t,n,a;let{canvasIdCallback:r,contentStateCallback:l,customDisplays:d=[],plugins:c=[],customTheme:u,iiifContent:p,id:h,manifestId:m,options:v,iiifContentSearchQuery:f}=e,g=p;h&&(g=h),m&&(g=m);let x=(0,o.as)(null==v?void 0:null===(n=v.informationPanel)||void 0===n?void 0:null===(t=n.vtt)||void 0===t?void 0:t.autoScroll);return(0,i.jsx)(o.MY,{initialState:{...o.W2,customDisplays:d,plugins:c,isAutoScrollEnabled:x.enabled,isInformationOpen:!!(null==v?void 0:null===(a=v.informationPanel)||void 0===a?void 0:a.open),vault:new s.j({customFetcher:e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tN,n=t.headers||tN.headers;return new Promise((i,a)=>{let o=new XMLHttpRequest;o.open("get",e),o.withCredentials=t.withCredentials,n&&Object.keys(n).forEach(e=>o.setRequestHeader(e,n[e])),o.onload=()=>{i({ok:o.status>=200&&o.status<300,status:o.status,statusText:o.statusText,headers:o.getAllResponseHeaders(),data:o.responseText,json:()=>JSON.parse(o.responseText)})},o.onerror=()=>{a(tO(o,"Failed to make request."))},o.ontimeout=()=>{a(tO(o,"Request took longer than expected."))},o.send()})})(e,{withCredentials:null==v?void 0:v.withCredentials,headers:null==v?void 0:v.requestHeaders}).then(e=>JSON.parse(e.data))})},children:(0,i.jsx)(tW,{iiifContent:g,canvasIdCallback:r,contentStateCallback:l,customTheme:u,options:v,iiifContentSearchQuery:f})})}},768:function(e,t,n){n.d(t,{g:function(){return i}});let i=(e,t,n,i)=>{let a={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]};if(a.canvas=e.get(t),a.canvas){var o,r;a.annotationPage=e.get(a.canvas.items[0]),a.accompanyingCanvas=(null===(o=a.canvas)||void 0===o?void 0:o.accompanyingCanvas)?e.get(null===(r=a.canvas)||void 0===r?void 0:r.accompanyingCanvas):void 0}if(a.annotationPage){let o=e.get(a.annotationPage.items).map(t=>({body:e.get(t.body[0].id),motivation:t.motivation,type:"Annotation"})),r=[];o.forEach(t=>{"Choice"===t.body.type?t.body.items.forEach(n=>r.push({...t,id:n.id,body:e.get(n.id)})):r.push(t)}),a.annotations=r.filter(a=>{if(a){if(!a.body||!a.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",a);return}let o=a.body;Array.isArray(o)&&(o=o[0]);let r=e.get(o.id);if(r)switch(n){case"painting":return a.target===t.id&&a.motivation&&"painting"===a.motivation[0]&&i.includes(r.type)&&(a.body=r),!!a;case"supplementing":return;default:throw Error("Invalid annotation motivation.")}}})}return a}},6016:function(e,t,n){n.d(t,{G:function(){return a}});var i=n(768);let a=(e,t)=>{let n=(0,i.g)(e,{id:t,type:"Canvas"},"painting",["Image","Sound","Video"]);if(0!==n.annotations.length&&n.annotations&&n.annotations)return n.annotations.map(e=>null==e?void 0:e.body)}},6216:function(e,t,n){n.d(t,{BC:function(){return a},F4:function(){return l},zo:function(){return o}});var i=n(6744);let a={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:o,css:r,keyframes:l,createTheme:s}=(0,i.Th)({theme:{colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"hsl(".concat(209," 100% 38.2%)"),accentMuted:"hsl(".concat(209," 80% 61.8%)"),accentAlt:"hsl(".concat(209," 80% 30%)"),secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 200ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},media:a})}}]);