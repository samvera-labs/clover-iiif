"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[574],{7467:function(e,t,i){i.d(t,{SV:function(){return s}});var r=i(5271);let n=(0,r.createContext)(null),a={didCatch:!1,error:null};class s extends r.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=a}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){let{error:e}=this.state;if(null!==e){for(var t,i,r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];null===(t=(i=this.props).onReset)||void 0===t||t.call(i,{args:n,reason:"imperative-api"}),this.setState(a)}}componentDidCatch(e,t){var i,r;null===(i=(r=this.props).onError)||void 0===i||i.call(r,e,t)}componentDidUpdate(e,t){let{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,i)=>!Object.is(e,t[i]))}(e.resetKeys,r)){var n,s;null===(n=(s=this.props).onReset)||void 0===n||n.call(s,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(a)}}render(){let{children:e,fallbackRender:t,FallbackComponent:i,fallback:a}=this.props,{didCatch:s,error:o}=this.state,l=e;if(s){let e={error:o,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)l=t(e);else if(i)l=(0,r.createElement)(i,e);else if(void 0!==a)l=a;else throw o}return(0,r.createElement)(n.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},l)}}},761:function(e,t,i){i.d(t,{a:function(){return a}});var r=Object.defineProperty,n=(e,t,i)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,a=(e,t,i)=>(n(e,"symbol"!=typeof t?t+"":t,i),i)},2017:function(e,t,i){i.d(t,{E:function(){return B},F:function(){return D},G:function(){return E},H:function(){return q},I:function(){return W},J:function(){return P},K:function(){return U},L:function(){return $}});var r="http://library.stanford.edu/iiif/image-api/compliance.html#level0",n="http://library.stanford.edu/iiif/image-api/compliance.html#level1",a="http://library.stanford.edu/iiif/image-api/compliance.html#level2",s="http://library.stanford.edu/iiif/image-api/conformance.html#level0",o="http://library.stanford.edu/iiif/image-api/conformance.html#level1",l="http://library.stanford.edu/iiif/image-api/conformance.html#level2",c="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",p="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",u="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",h="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",f="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",v="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",m="http://iiif.io/api/image/1/level0.json",y="http://iiif.io/api/image/1/profiles/level0.json",d="http://iiif.io/api/image/1/level1.json",g="http://iiif.io/api/image/1/profiles/level1.json",A="http://iiif.io/api/image/1/level2.json",b="http://iiif.io/api/image/1/profiles/level2.json",C="http://iiif.io/api/image/2/level0.json",x="http://iiif.io/api/image/2/profiles/level0.json",j="http://iiif.io/api/image/2/level1.json",w="http://iiif.io/api/image/2/profiles/level1.json",L="http://iiif.io/api/image/2/level2.json",S="http://iiif.io/api/image/2/profiles/level2.json",R="level0",I="level1",k="level2",T="http://iiif.io/api/image/2/level0",O="http://iiif.io/api/image/2/level1",M="http://iiif.io/api/image/2/level2",B=[M,a,l,u,v,A,b,L,S,k],D=[...B,O,n,o,p,f,d,g,j,w,I],E=[T,O,M,r,n,a,s,o,l,c,p,u,h,f,v,m,y,d,g,A,b,C,x,j,w,L,S,R,I,k],q=E,W=[T,r,s,c,h,m,y,C,x,R],P={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},U={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},$={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]}},781:function(e,t,i){function r(e){for(let t in e)(typeof e[t]>"u"||null===e[t])&&delete e[t];return e}function n(e){return Array.isArray(e)?e:e?[e]:[]}i.d(t,{a:function(){return n},b:function(){return r}})},5474:function(e,t,i){i.d(t,{h:function(){return L}});var r=i(2017),n=i(781),a=i(761),s=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"],o=class e{constructor(e,t={}){(0,a.a)(this,"traversals"),(0,a.a)(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...t}}static all(t){return new e({collection:[t],manifest:[t],canvas:[t],annotationList:[t],sequence:[t],annotation:[t],contentResource:[t],choice:[t],range:[t],service:[t],layer:[t]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let t=[...(e.manifests||[]).map(e=>"string"==typeof e?{"@id":e,"@type":"sc:Manifest"}:e),...(e.collections||[]).map(e=>"string"==typeof e?{"@id":e,"@type":"sc:Collection"}:e),...e.members||[]],i=[],r=t.filter(e=>!i.includes(e["@id"])&&(i.push(e["@id"]),!0));delete e.collections,delete e.manifests,e.members=r}return e.manifests&&(e.manifests=e.manifests.map(e=>this.traverseManifest("string"==typeof e?{"@id":e,"@type":"sc:Manifest"}:e))),e.collections&&(e.collections=e.collections.map(e=>this.traverseCollection("string"==typeof e?{"@id":e,"@type":"sc:Collection"}:e))),e.members&&(e.members=e.members.map(e=>"string"==typeof e?e:"sc:Collection"===e["@type"]?this.traverseCollection(e):"sc:Manifest"===e["@type"]?this.traverseManifest(e):this.traverseUnknown(e))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(e=>this.traverseSequence(e))),e.structures&&(e.structures=e.structures.map(e=>this.traverseRange(e))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(e=>this.traverseCanvas(e))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(e=>this.traverseAnnotation(e))),e.otherContent&&(e.otherContent=e.otherContent.map(e=>this.traverseAnnotationList(e))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map(e=>"string"==typeof e?{"@id":e,"@type":"sc:Range"}:e),...(e.canvases||[]).map(e=>"string"==typeof e?{"@id":e,"@type":"sc:Canvas"}:e),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(e=>this.traverseUnknown(e)):void 0}return e}traverseAnnotationList(e){return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems("string"==typeof e?{"@id":e,"@type":"sc:AnnotationList"}:e)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(e=>this.traverseAnnotation(e))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(e=>this.traverseContentResource(e)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(e=>this.traverseAnnotationList(e))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&"rdf:nil"!==e.default&&(e.default=this.traverseContentResource(e.default)),e.item&&"rdf:nil"!==e.item&&(e.item=e.item.map(e=>this.traverseContentResource(e))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return"oa:Choice"===e["@type"]?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||"string"==typeof e)return e;switch(function(e){if(typeof e>"u"||null===e)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw Error("Array is not a valid entity");if("object"!=typeof e)throw Error(`${typeof e} is not a valid entity`);if("string"==typeof e["@type"]){let t=s.indexOf(e["@type"]);if(-1!==t)return s[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw Error("Resource type is not known")}(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let e of i)"string"==typeof e?r.push(this.traverseContentResource({"@id":e,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(e));return t||this.options.convertPropsToArray?r:r[0]}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let e of i)r.push(this.traverseService(e));return t||this.options.convertPropsToArray?r:r[0]}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&("string"==typeof e.within||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&("string"==typeof e.startCanvas?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&("string"==typeof e.contentLayer?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e)){if(!this.options.convertPropsToArray)return this.traverseType(e,t);e=[e]}return e.map(e=>this.traverseType(e,t))}traverseType(e,t){return t.reduce((e,t)=>{let i=t(e);return typeof i>"u"&&!this.options.allowUndefinedReturn?e:i},e)}},l=["http://iiif.io/api/image/2/level1","http://iiif.io/api/image/2/level2","http://library.stanford.edu/iiif/image-api/compliance.html#level1","http://library.stanford.edu/iiif/image-api/compliance.html#level2","http://library.stanford.edu/iiif/image-api/conformance.html#level1","http://library.stanford.edu/iiif/image-api/conformance.html#level2","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2","http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1","http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2","http://iiif.io/api/image/1/level1.json","http://iiif.io/api/image/1/profiles/level1.json","http://iiif.io/api/image/1/level2.json","http://iiif.io/api/image/1/profiles/level2.json","http://iiif.io/api/image/2/level1.json","http://iiif.io/api/image/2/profiles/level1.json","http://iiif.io/api/image/2/level2.json","http://iiif.io/api/image/2/profiles/level2.json","level1","level2"],c={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:""};function p(e,t="none"){if(!e)return{none:[""]};let i=function(e){if("string"==typeof e)return[e];if(!e)return[];let t=Array.isArray(e)?e:[e],i=[];for(let e of t){if("string"==typeof e){i.push(e);continue}i.push({"@language":e["@language"]||e.language,"@value":e["@value"]||e.value})}return i}(e),r={};for(let e of i){if("string"==typeof e){r[t]=r[t]?r[t]:[],r[t].push(e||"");continue}if(!e["@language"]){r[t]=r[t]?r[t]:[],r[t].push(e["@value"]||"");continue}let i=e["@language"];r[i]=r[i]?r[i]:[],r[i].push(e["@value"]||"")}return 0===Object.keys(r).length?{none:[""]}:r}function u(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}var h=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function f(e){let t=e["@id"]||e.id,i=e["@type"]||e.type,r=e.profile||void 0,n=e["@context"]||void 0;if(r){let e=function(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}(r);if(e)return e}if(n){let e=function(e){for(let t of Array.isArray(e)?e:[e])switch(t){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}(n);if(e)return e}if(i){if(Array.isArray(i)){if(-1!==i.indexOf("oa:CssStylesheet"))return"CssStylesheet";if(-1!==i.indexOf("cnt:ContentAsText"))return"TextualBody";i=i[0]}for(let e of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${e}:`)){i=i.slice(e.length+1);break}switch(i){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(i&&-1!==h.indexOf(i))return i;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||"application/pdf"===e.format)return"Text";if(e.format.startsWith("application/"))return"Dataset"}return t&&(t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".jpeg"))?"Image":i||"unknown"}var v=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm,m=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"],y=0;function d(e,t){let i=encodeURI(e.id||e["@id"]||"").trim();return i&&t?`${i}/${t}`:i||(y++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${y}`)}function g(e){let t,i=[...e.behavior||[]];return e.viewingHint&&i.push(e.viewingHint),Array.isArray(e.motivation)?t=e.motivation.map(u):e.motivation&&(t=u(e.motivation)),{"@context":e["@context"]?function(e){if(e){let t=Array.isArray(e)?e:[e],i=[];for(let e of t)"http://iiif.io/api/presentation/2/context.json"===e&&i.push("http://iiif.io/api/presentation/3/context.json"),-1===m.indexOf(e)&&i.push(e);if(t.length)return 1===i.length?i[0]:i}}(e["@context"]):void 0,id:(e["@id"]||d(e)).trim(),type:f(e),behavior:i.length?i:void 0,height:e.height?e.height:void 0,width:e.width?e.width:void 0,motivation:t,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:void 0,duration:void 0,timeMode:void 0}}function A(e){var t,i;let[r,n]=function(e,t="Rights/License",i="none"){let r=null,n=[];for(let a of Array.isArray(e)?e:[e]){let e=a?function(e){let t=e.match(v);return t?t[0]:e}(a):void 0;if(e&&(-1!==e.indexOf("creativecommons.org")||-1!==e.indexOf("rightsstatements.org"))){r=e.startsWith("https://")?`http://${e.slice(8)}`:e;continue}e&&n.push({label:{[i]:[t]},value:{[i]:[e]}})}return[r,n]}(e.license),a=[...e.metadata&&(t=e.metadata)?t.map(e=>({label:p(e.label),value:p(e.value)})):[],...n];return{rights:r,metadata:a.length?a:void 0,label:e.label?p(e.label):void 0,requiredStatement:e.attribution?{label:p(c.attributionLabel),value:p(e.attribution)}:void 0,navDate:e.navDate,summary:e.description?p(e.description):void 0,thumbnail:(i=e.thumbnail)&&(Array.isArray(i)?i:[i]).map(e=>"string"==typeof e?{id:e,type:"Image"}:("unknown"===e.type&&(e.type="Image"),e))}}function b(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],i=e.contentLayer;return{provider:e.logo||t.length?[{id:c.providerId,type:"Agent",homepage:t.length?[t[0]]:void 0,logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:void 0,label:p(c.providerName)}]:void 0,partOf:function(e){if(!e.within)return;let t=Array.isArray(e.within)?e.within:[e.within],i=[];for(let r of t)"string"==typeof r?r&&"sc:Manifest"===e["@type"]&&i.push({id:r,type:"Collection"}):r["@id"]&&i.push({id:r["@id"],type:f(r)});return i.length?i:void 0}(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?(0,n.a)(e.service):void 0,supplementary:i?[i]:void 0}}function C(e,t){return e?"string"==typeof e?{id:e,type:t}:"string"==typeof e?.["@id"]?{id:e["@id"],type:t}:"string"==typeof e.id?{id:e.id,type:t}:null:null}function x(e){return"Choice"===e.type?e:j(e)}function j(e){return(0,n.b)({...g(e),...A(e),...b(e),chars:e.chars,format:e.format?e.format:void 0,language:e.language})}var w=new o({collection:[function(e){return(0,n.b)({...g(e),...A(e),...b(e),...function(e){let t={};if(e.first){let i=C(e.first,"Collection");i&&(t.first=i)}if((e.total||0===e.total)&&(t.total=e.total),e.prev){let i=C(e.prev,"Collection");i&&(t.prev=i)}if(e.next){let i=C(e.next,"Collection");i&&(t.next=i)}return t}(e),items:function(e){let t=[];for(let i of e){let e={...i};e.items&&0===e.items.length&&delete e.items,t.push(e)}return t}(e.members)})}],manifest:[function(e){let t=[],i=[],r,a;for(let n of e.sequences||[])n.canvases.length&&t.push(...n.canvases),n.behavior&&i.push(...n.behavior),n.viewingDirection&&(a=n.viewingDirection),n.startCanvas&&(r=n.startCanvas);let s=g(e);return i.length&&(s.behavior?s.behavior.push(...i):s.behavior=i),(0,n.b)({...s,...A(e),...b(e),viewingDirection:a,start:r,items:t,structures:function(e){if(!e)return e;let t=new Map;for(let i of e)t.set(i.id,i);let i=[];for(let r of e)if(r.items){let e=r.items.map(e=>"string"==typeof e?(i.push(e),t.get(e)||e):e&&e.id?(i.push(e.id),t.get(e.id)||e):e);r.items=e}return e.filter(e=>-1===i.indexOf(e.id))}(e.structures)})}],canvas:[function(e){return(0,n.b)({...g(e),...A(e),...b(e),annotations:e.otherContent&&e.otherContent.length?e.otherContent:void 0,items:e.images&&e.images.length?[{id:d(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:void 0})}],annotationList:[function(e){return(0,n.b)({...g(e),...A(e),...b(e),items:e.resources&&e.resources.length?e.resources:void 0})}],sequence:[function(e){return e.canvases&&0!==e.canvases.length?{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[],viewingDirection:e.viewingDirection,startCanvas:e.startCanvas}:{canvases:[],behavior:[]}}],annotation:[function(e){return(0,n.b)({...g(e),...A(e),...b(e),target:function e(t){if(Array.isArray(t)){if(t.length>1)return{type:"List",items:t.map(e)};t=t[0]}if("string"==typeof t)return encodeURI(t).trim();if(!("@type"in t))return encodeURI(t["@id"]).trim();{let e;if("string"==typeof t.full)e=t.full;else if("dctypes:Image"===t.full["@type"])e={id:t.full["@id"],type:"Image"};else if("sc:Canvas"===t.full["@type"])e={id:t.full["@id"],type:"Canvas"};else throw Error(`Unsupported source type on annotation: ${t.full["@type"]}`);return{type:"SpecificResource",source:e,selector:function e(t){if((Array.isArray(t["@type"])&&t["@type"].includes("oa:SvgSelector")||"oa:SvgSelector"==t["@type"])&&("chars"in t||"value"in t))return{type:"SvgSelector",value:"chars"in t?t.chars:t.value};if("oa:FragmentSelector"===t["@type"])return{type:"FragmentSelector",value:t.value};if("oa:Choice"===t["@type"])return[e(t.default),...(Array.isArray(t.item)?t.item:[t.item]).map(e)];if("iiif:ImageApiSelector"==t["@type"])return{type:"ImageApiSelector",region:"region"in t?t.region:void 0,rotation:"rotation"in t?t.rotation:void 0};throw Error(`Unsupported selector type: ${t["@type"]}`)}(t.selector)}}}(e.on),body:Array.isArray(e.resource)?e.resource.map(x):x(e.resource)})}],contentResource:[j],choice:[function(e){let t=[];return e.default&&"rdf:nil"!==e.default&&t.push(e.default),e.item&&"rdf:nil"!==e.item&&t.push(...e.item),(0,n.b)({...g(e),...A(e),items:t})}],range:[function(e){return(0,n.b)({...g(e),...A(e),...b(e),items:e.members})}],service:[function(e){let{"@id":t,"@type":i,"@context":a,profile:s,...o}=e,c={};return t&&(c["@id"]=t),c["@type"]=f(e),"unknown"===c["@type"]&&(a&&a.length&&(c["@context"]=a),c["@type"]="Service"),s&&(c.profile=function e(t){return Array.isArray(t)?e(t.find(e=>"string"==typeof e)):-1!==r.E.indexOf(t)?"level2":-1!==l.indexOf(t)?"level1":-1!==r.H.indexOf(t)?"level0":"string"==typeof t?t:void 0}(s)),(0,n.b)({...c,...o})}],layer:[function(e){return(0,n.b)({...g(e),...A(e),...b(e)})}]});function L(e){return e&&e["@context"]&&("http://iiif.io/api/presentation/2/context.json"===e["@context"]||-1!==e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")||"http://www.shared-canvas.org/ns/context.json"===e["@context"])||"http://iiif.io/api/image/2/context.json"===e["@context"]||e["@id"]&&"sc:Collection"===e["@type"]||e["@id"]&&"sc:Manifest"===e["@type"]?(e["@context"]||(e["@context"]="http://iiif.io/api/presentation/2/context.json"),w.traverseUnknown(e)):e}}}]);